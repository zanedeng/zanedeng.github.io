import{a as e,b as t,g as i}from"./theme.BxpiuCfN.js";import{c as s}from"./collapse-vguOFti0.Cu2FP3Px.js";import{s as a}from"./uuid-BZTOj-_U.D3oPmf8g.js";import{n}from"./nextFrame-BGGLuZuD.CXhuHsRE.js";import{u as r}from"./useNamespace-HoRSxEcr.Ve2NNMUK.js";import"./framework.N_gL8lMw.js";function l(e){return"auto"===e?0:1e3*Number(e.slice(0,-1).replace(",","."))}function o(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((t,i)=>l(t)+l(e[i])))}const c="transition",d="animation";function h(e,t){const i=window.getComputedStyle(e),s=e=>(i[e]||"").split(", "),a=s(`${c}Delay`),n=s(`${c}Duration`),r=o(a,n);o(s(`${d}Delay`),s(`${d}Duration`));let l=null,h=0,p=0;r>0&&(l=c,h=r,p=n.length);return{hasTransform:l===c&&/\b(?:transform|all)(?:,|$)/.test(s(`${c}Property`).toString()),propCount:p,timeout:h,type:l}}const p=r("collapse"),u=class{constructor(t){e(this,t),this.focusing=!1,this.icon="arrow-right",this.isActive=!1,this.isClick=!1,this.label="",this.handleHeaderClick=e=>{var t;if(this.disabled)return;const i=e.target;(null==i?void 0:i.closest("input, textarea, select"))||(null===(t=this.collapseContext)||void 0===t||t.handleItemClick(this.collapseItemName),this.focusing=!1,this.isClick=!0)}}get arrowKls(){return[p.be("item","arrow"),p.is("active",this.isActive)].join(" ")}get collapseContext(){let e=this.el.parentElement,t=null;for(;e;){if("ZANE-COLLAPSE"===e.tagName){t=s.get(e);break}e=e.parentElement}return t}get collapseItemName(){var e;return null!==(e=this.name)&&void 0!==e?e:`${p.namespace}-id-${a.idInjection.prefix}-${this.id}`}get headKls(){return[p.be("item","header"),p.is("active",this.isActive),this.focusing&&!this.disabled?"focusing":""].join(" ")}get id(){return a.idInjection.current++}get itemContentKls(){return p.be("item","content")}get itemTitleKls(){return p.be("item","title")}get itemWrapperKls(){return p.be("item","wrap")}get rootKls(){return[p.b("item"),p.is("active",this.isActive),p.is("disabled",this.disabled)].join(" ")}get scopedContentId(){return p.b(`content-${this.id}`)}get scopedHeadId(){return p.b(`head-${this.id}`)}componentDidLoad(){const e=getComputedStyle(this.wrapperRef);this.wrapperHeight=e.height,this.isActive?this.handleShow():this.handleHidden()}componentWillLoad(){this.updateCallback=()=>{const e=this.collapseContext;e&&(this.isActive=e.activeNames.includes(this.name))};const e=this.collapseContext;e&&(this.isActive=e.activeNames.includes(this.name),e.addActiveNamesChangeListener(this.updateCallback))}disconnectedCallback(){var e;null===(e=this.collapseContext)||void 0===e||e.removeActiveNamesChangeListener(this.updateCallback)}handleEnterClick(e){var t;const i=e.target;(null==i?void 0:i.closest("input, textarea, select"))||(e.preventDefault(),null===(t=this.collapseContext)||void 0===t||t.handleItemClick(this.collapseItemName))}handleFocus(){setTimeout(()=>{this.isClick?this.isClick=!1:this.focusing=!0},50)}handleHidden(){if(this.wrapperRef){const{timeout:e}=h(this.wrapperRef);this.wrapperRef.style.height="0",function(e,t,i,s){const a=e._endId=(e._endId||0)+1,n=()=>{a===e._endId&&s()};if(null!==i)return void setTimeout(n,i);const{propCount:r,timeout:l,type:o}=h(e);if(!o)return void s();const c=`${o}end`;let d=0;const p=()=>{e.removeEventListener(c,u),n()},u=t=>{t.target===e&&++d>=r&&p()};setTimeout(()=>{d<r&&p()},l+1),e.addEventListener(c,u)}(this.wrapperRef,0,e,()=>{this.wrapperRef.style.display="none"})}}handleShow(){this.wrapperRef&&(this.wrapperRef.style.display="",n(()=>{this.wrapperRef.style.height=this.wrapperHeight}))}render(){return t("div",{key:"6d80050c834a526620229db60b22c729f71393d0",class:this.rootKls},t("div",{key:"eb86b9e92f1182ec1a25f50cbdd0240d3b54df64",class:this.headKls,id:this.scopedHeadId,onBlur:()=>this.focusing=!1,onClick:this.handleHeaderClick,onFocus:this.handleFocus,onKeyDown:this.handleEnterClick,role:"button",tabindex:this.disabled?-1:0},t("span",{key:"c254462eb94f4d42612444c6938a9f6d7f641c13",class:this.itemTitleKls},t("slot",{key:"f67c5ff7d5cca070644415786f9b1deb7c01c147",name:"title"},this.label)),t("slot",{key:"796123a540c281d8e61038160262bb32a90110ef",name:"icon"},this.icon&&t("zane-icon",{key:"9c41e59d31bbe30de0a439c7681a2ff279070982",class:this.arrowKls,name:this.icon}))),t("div",{key:"dcb95525e837b721527eb6d159d69270b11e368f",class:this.itemWrapperKls,id:this.scopedContentId,ref:e=>this.wrapperRef=e},t("div",{key:"a9077931ddbf23990faebcb71b708616906d01a5",class:this.itemContentKls},t("slot",{key:"4f6b5c8c7ae9c6d87dde77c0eb8107ca08533b21"}))))}watchIsActiveHandler(e){e?this.handleShow():this.handleHidden()}get el(){return i(this)}static get watchers(){return{isActive:[{watchIsActiveHandler:0}]}}};export{u as zane_collapse_item};
