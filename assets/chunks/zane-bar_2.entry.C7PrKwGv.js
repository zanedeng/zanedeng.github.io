import{a as t,b as e,c as s,g as i}from"./theme.BxpiuCfN.js";import{s as r,G as a,B as o}from"./scrollbar-BkQhOBil.Bj4lMJyn.js";import{i as l}from"./isClient-VXT6p8t0.BWwfHtBD.js";import"./uuid-BZTOj-_U.D3oPmf8g.js";import{u as n}from"./useNamespace-HoRSxEcr.Ve2NNMUK.js";import"./framework.N_gL8lMw.js";const h=class{constructor(e){t(this,e),this.moveX=0,this.moveY=0,this.ratioX=1,this.ratioY=1,this.sizeHeight="",this.sizeWidth=""}get scrollbarContext(){let t=this.el.parentElement,e=null;for(;t;){if("ZANE-SCROLLBAR"===t.tagName){e=r.get(t);break}t=t.parentElement}return e}async handleScroll(t){if(t){const e=t.offsetHeight-a,s=t.offsetWidth-a;this.moveY=100*t.scrollTop/e*this.ratioY,this.moveX=100*t.scrollLeft/s*this.ratioX}}render(){return e(s,{key:"ea377501d1432ad26f41f2526f73eab5ed64bd29"},e("zane-thumb",{key:"56ff0bf173b8bedad8621b0326990245cb4c24e0",always:this.always,move:this.moveX,ratio:this.ratioX,size:this.sizeWidth}),e("zane-thumb",{key:"e8ccb4067fe314b1a856af9a70e7d523339a7ed9",always:this.always,move:this.moveY,ratio:this.ratioY,size:this.sizeHeight,vertical:!0}))}async update(){var t;const e=null===(t=this.scrollbarContext)||void 0===t?void 0:t.wrapElement;if(!e)return;const s=e.offsetHeight-a,i=e.offsetWidth-a,r=s**2/e.scrollHeight,o=i**2/e.scrollWidth,l=Math.max(r,this.minSize),n=Math.max(o,this.minSize);this.ratioY=r/(s-r)/(l/(s-l)),this.ratioX=o/(i-o)/(n/(i-n)),this.sizeHeight=l+a<s?`${l}px`:"",this.sizeWidth=n+a<i?`${n}px`:""}get el(){return i(this)}},c=n("scrollbar"),m=class{constructor(e){t(this,e),this.thumbState={},this.visible=!1,this.baseScrollHeight=0,this.baseScrollWidth=0,this.cursorDown=!1,this.cursorLeave=!1,this.originalOnSelectStart=l?document.onselectstart:null,this.clickHandler=t=>{t.stopPropagation()},this.clickThumbHandler=t=>{var e;if(t.stopPropagation(),t.ctrlKey||[1,2].includes(t.button))return;null===(e=window.getSelection())||void 0===e||e.removeAllRanges(),this.startDrag(t);const s=t.currentTarget;s&&(this.thumbState[this.bar.axis]=s[this.bar.offset]-(t[this.bar.client]-s.getBoundingClientRect()[this.bar.direction]))},this.clickTrackHandler=t=>{if(!this.thumbRef||!this.instanceRef||!this.scrollbarContext.wrapElement)return;const e=100*(Math.abs(t.target.getBoundingClientRect()[this.bar.direction]-t[this.bar.client])-this.thumbRef[this.bar.offset]/2)*this.offsetRatio/this.instanceRef[this.bar.offset];this.scrollbarContext.wrapElement[this.bar.scroll]=e*this.scrollbarContext.wrapElement[this.bar.scrollSize]/100},this.mouseLeaveScrollbarHandler=()=>{this.cursorLeave=!0,this.visible=this.cursorDown},this.mouseMoveDocumentHandler=t=>{if(!this.instanceRef||!this.thumbRef)return;if(!1===this.cursorDown)return;const e=this.thumbState[this.bar.axis];if(!e)return;const s=100*(-1*(this.instanceRef.getBoundingClientRect()[this.bar.direction]-t[this.bar.client])-(this.thumbRef[this.bar.offset]-e))*this.offsetRatio/this.instanceRef[this.bar.offset];this.scrollbarContext.wrapElement[this.bar.scroll]="scrollLeft"===this.bar.scroll?s*this.baseScrollWidth/100:s*this.baseScrollHeight/100},this.mouseMoveScrollbarHandler=()=>{this.cursorLeave=!1,this.visible=!!this.size},this.mouseUpDocumentHandler=()=>{this.cursorDown=!1,this.thumbState[this.bar.axis]=0,document.removeEventListener("mousemove",this.mouseMoveDocumentHandler),document.removeEventListener("mouseup",this.mouseUpDocumentHandler),this.restoreOnselectstart(),this.cursorLeave&&(this.visible=!1)},this.restoreOnselectstart=()=>{document.onselectstart!==this.originalOnSelectStart&&document.addEventListener("selectstart",this.originalOnSelectStart)},this.startDrag=t=>{t.stopImmediatePropagation(),this.cursorDown=!0,this.baseScrollHeight=this.scrollbarContext.wrapElement.scrollHeight,this.baseScrollWidth=this.scrollbarContext.wrapElement.scrollWidth,document.addEventListener("mousemove",this.mouseMoveDocumentHandler),document.addEventListener("mouseup",this.mouseUpDocumentHandler),this.originalOnSelectStart=document.onselectstart,document.addEventListener("selectstart",()=>!1)}}get bar(){return o[this.vertical?"vertical":"horizontal"]}get offsetRatio(){return this.instanceRef&&this.thumbRef&&this.scrollbarContext.wrapElement?this.instanceRef[this.bar.offset]**2/this.scrollbarContext.wrapElement[this.bar.scrollSize]/this.ratio/this.thumbRef[this.bar.offset]:1}get scrollbarContext(){let t=this.el.parentElement,e=null;for(;t;){if("ZANE-SCROLLBAR"===t.tagName){e=r.get(t);break}t=t.parentElement}return e}componentDidLoad(){var t,e;null===(t=this.scrollbarContext.scrollbarElement)||void 0===t||t.addEventListener("mousemove",this.mouseMoveScrollbarHandler),null===(e=this.scrollbarContext.scrollbarElement)||void 0===e||e.addEventListener("mouseleave",this.mouseLeaveScrollbarHandler)}disconnectedCallback(){var t,e,s,i;this.restoreOnselectstart(),document.removeEventListener("mouseup",this.mouseUpDocumentHandler),null===(e=null===(t=this.scrollbarContext)||void 0===t?void 0:t.scrollbarElement)||void 0===e||e.removeEventListener("mousemove",this.mouseMoveScrollbarHandler),null===(i=null===(s=this.scrollbarContext)||void 0===s?void 0:s.scrollbarElement)||void 0===i||i.removeEventListener("mouseleave",this.mouseLeaveScrollbarHandler)}render(){const t={[this.bar.size]:this.size,transform:`translate${this.bar.axis}(${this.move}%)`};return e(s,{key:"41693ed234a17efae18ac75761e8b51f5432a0b1",class:c.b("fade")},e("div",{key:"4582443efe01d03a1092dd6c3810bedfcf71969a",class:[c.e("bar"),c.is(this.bar.key)].join(" "),onClick:this.clickHandler,onMouseDown:this.clickTrackHandler,ref:t=>this.instanceRef=t,style:{display:this.always||this.visible?"":"none"}},e("div",{key:"d21e21d3a1a42675ab0a3a40e84229773edb3a16",class:c.e("thumb"),onMouseDown:this.clickThumbHandler,ref:t=>this.thumbRef=t,style:t})))}get el(){return i(this)}};export{h as zane_bar,m as zane_thumb};
